{"version":3,"file":"single-spa.js","sources":["../../src/start.js","../../src/navigations/reroute.js","../../src/applications/app.helper.js","../../src/applications/app.js"],"sourcesContent":["import { reroute } from \"./navigations/reroute\";\n\nexport let started = false\n\nexport function start() {\n    //挂载应用\n    started = true\n    //需要先加载应用，再挂载\n    reroute()\n}","import { getAppChanges } from \"../applications/app\";\nimport { started } from \"../start\";\n\nexport function reroute() {\n    const { appsToLoad,appsToMount, appsToUnmount } = getAppChanges()\n    console.log(111, appsToLoad,appsToMount, appsToUnmount)\n\n    if(started){\n        // app装载\n        console.log('调用 start')\n        return performAppChanges() // 根据路径来装载应用\n    } else {\n        // 注册应用时， 需要预先加载\n        console.log('调用 register')\n        return loadApps() //预加载应用\n    }\n\n    async function loadApps() { // 预加载应用\n\n    }\n\n    async function performAppChanges() { // 根据路径装载应用\n\n    }\n}","// 描述应用的整个状态\nexport const NOT_LOADED = 'NOT_LOADED' // 应用初始状态\n\nexport const LOADING_SOURCE_CODE = 'LOADING_SOURCE_CODE' // 加载资源\n\nexport const NOT_BOOTSTRAPPED = 'NOT_BOOTSTRAPPED' // 还没有调用bootstrap方法\n\nexport const BOOTSTRAPPING = 'BOOTSTRAPPING' // 启动中\n\nexport const NOT_MOUNTED = 'NOT_MOUNTED' // 没有调用 Mounted 方法\n\nexport const MOUNTING = 'MOUNTING' // 正在挂载中\n\nexport const MOUNTED = 'MOUNTED' // 挂载完毕\n\nexport const UPDATING = 'UPDATING' // 更新中\n\nexport const UNMOUNTING = 'UNMOUNTING' // 解除挂载\n\nexport const UNLOADING = 'UNLOADING' // 完全卸载中\n\nexport const LOAD_ERR = 'LOAD_ERR' // 资源加载失败\n\nexport const SKIP_BECAUSE_BROKEN = 'SKIP_BECAUSE_BROKEN' // 代码出错\n\n// 当前应用是否被激活\nexport function isActive(app) {\n    return app.status === MOUNTED\n}\n\nexport function shouldBeActive(app) {\n    return app.activeWhen(window.location)\n}\n","import { reroute } from \"../navigations/reroute\"\nimport { BOOTSTRAPPING, LOADING_SOURCE_CODE, LOAD_ERR, MOUNTED, NOT_BOOTSTRAP, NOT_BOOTSTRAPPED, NOT_LOADED, NOT_MOUNTED, shouldBeActive, SKIP_BECAUSE_BROKEN } from \"./app.helper\"\n\nconst apps = []\n\nexport function registerApplication(appName, loadApp,activeWhen, customProps) {\n    apps.push({\n        name: appName,\n        loadApp,\n        activeWhen,\n        customProps,\n        status: NOT_LOADED\n    })\n    reroute() // 加载应用\n    console.log(apps)\n}\n\nexport function getAppChanges() {\n    const appsToUnmount = [] // 要卸载的app\n    const appsToLoad = [] // 要加载的app\n    const appsToMount = [] // 需要挂载的\n    apps.forEach((app) => {\n        debugger\n        const appShouldBeActive = app.status !== SKIP_BECAUSE_BROKEN && shouldBeActive(app)\n    \n        switch(app.status) {\n            case NOT_LOADED: \n            case LOADING_SOURCE_CODE:\n                if(appShouldBeActive) {\n                    appsToLoad.push(app)\n                }\n                break;\n            case NOT_BOOTSTRAPPED:\n            case BOOTSTRAPPING:\n            case NOT_MOUNTED:\n                if(appShouldBeActive){\n                    appsToMount.push(app)\n                }\n                break;\n            case MOUNTED:\n                if(!appShouldBeActive) {\n                    appsToUnmount.push(app)\n                }\n                break;\n            default: \n                break;\n        }\n\n        \n    })\n\n    return {\n        appsToLoad,\n        appsToMount,\n        appsToUnmount\n    }\n}"],"names":[],"mappings":"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"}